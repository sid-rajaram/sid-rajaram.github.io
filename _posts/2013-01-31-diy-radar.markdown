---
layout: post
title:  "Results from DIY Coffee Can Radar Build"
date:   2013-01-31
usemathjax: true
---
*I wrote up this post a long time ago and ported it over to this site.*

I took a 4-day course on building a coffee can antenna (a "cantenna") radar system capable of sensing range, doppler, and synthetic aperture radar imaging. This was organized (and funded) by [Lincoln Labs](http://www.ll.mit.edu/) during MIT's Independent Activities Period in January of 2013. The project was originally developed by Dr. Greg Charvat, formerly at Lincoln Labs, whose [site](http://www.glcharvat.com/Dr._Gregory_L._Charvat_Projects/Home.html) has much more detailed information. Slides from the class, which contain a bill of materials and detailed step-by-step build instructions, are available on [MIT OpenCourseWare](http://ocw.mit.edu/resources/res-ll-003-build-a-small-radar-system-capable-of-sensing-range-doppler-and-synthetic-aperture-radar-imaging-january-iap-2011/index.htm). The final product (assembled by groups of 3 students) looks like this:

| ![Final build](/assets/coffee_can_radar/radar_final.jpg) |
|:--:|
| Coffee can radar - final build |

The two metal coffee cans act as circular waveguides for the antennas (one is to transmit, the other to receive). The antennas are monopole wire probes (see image below) that are attached to coaxial cables that carry the signal to and from the RF electronics. The distance between the wire probes and the back of the cans (where the blue wires connect to the cans in the image above) must be one quarter of the wavelength of the carrier frequency we use (2.4Ghz - the ISM band, also the frequency used by wifi networks), since there is a π shift when the signal is reflected off the back wall and π/2 shifts involved in traveling back and forth from the back wall at this length, adding to a total 2π shift, maximizing signal power.

| ![Wire probe](/assets/coffee_can_radar/wire_probe.jpg) |
|:--:|
| Wire probe |

A entire system layout is illustrated below (image taken from course slides):

| ![System layout](/assets/coffee_can_radar/system_layout.png) |
|:--:|
| System layout |

The device is capable of measuring Doppler (velocity), range (distance), and being used as a synthetic aperture radar (multiple range measurements used to reconstruct a 2D projected image) and I will go through the data from each.

### Doppler

Doppler mode is relatively simple - the transmit antenna puts out a constant sinusoidal wave at 2.4GHz. The radar Doppler shift frequency is 2.velocity/wavelength ([derivation](https://en.wikipedia.org/wiki/Doppler_radar#Frequency_variation)). The velocity here refers to the radial velocity component of the object and the wavelength is given by *c*/2.4GHz = 12.5cm, where *c* is the speed of light. Therefore, a car moving at 35mph would show a Doppler shift of roughly 250Hz, which is in the range to be picked up by a computer soundcard (the data acquisition device on this system was the microphone port on a laptop). Note however this is the Doppler shift, which means the actual signal being received at the antenna are sinusoids at a frequency of 2.4GHz +/- 250Hz. To modify this so that we only pick up the frequency shifts, we just multiply the received signal with the transmitted signal. Then due to the identity

$$sin(A)sin(B) = \frac{1}{2}\cdot(cos(A-B) - cos(A+B))$$

we will pick up the Doppler shift frequency as the sum or difference (depending on whether the imaged object is moving away from or towards the aperture). Either way we can filter out higher frequencies and only retain the Doppler shift frequencies in our signal. In the system layout figure above, the mixer does this multiplication of transmitted and received signals, and the low pass filter gets rid of the higher frequencies (which we need to prevent aliasing anyway). Shown below is a Doppler plot of me waving my hand with increasing speeds towards and away from the radar aperture - note that time is on the y-axis.

| ![Doppler plot of hand waving](/assets/coffee_can_radar/hand_wave.png) |
|:--:|
| Doppler plot of hand waving |

### Range

Range measurements are a little more involved - the idea is to send out a pulsed waveform and see how long the signal takes to bounce back. In this implementation, the transmitter sends out little 20ms long chirped pulses, with the instantaneous frequency linearly increasing from 2.4Ghz to 2.48GHz. This was implemented with an IC that sends out linear voltage ramps to a voltage controlled oscillator. The signal is received back with some time delay and the distance to the object is just 2.delay/*c*. Theoretically, ranging would be done by running a matched filter, with the impulse response being the transmitted chirp, and looking for a peak. Practically that is hard (impossible?) to do at RF frequencies. What is done instead is a trick called *stretch processing* ([derivation](http://www.ece.uah.edu/courses/material/EE710-Merv/Stretch_11.pdf)). The idea is that multiplying the return signal with the transmitted signal will produce constant frequency sinusoids with the frequency proportional to the time delay, and the distance to the target. This only works if the received signal is picked up while the transmit is still going, but with 20ms pulses that should be the case for any reasonable distances. To calibrate our range measurements we walked up and down a 20 m hallway and produced the image below.

| ![Range measurements of waking down a hallway](/assets/coffee_can_radar/corridor_walk.png) |
|:--:|
| Range measurements of waking down a hallway |

With this calibrated, we then pointed it out on a street and performed ranging on passing cars (at 2am, in well below freezing temperatures), plotted below.

| ![Range measurements of cars driving by](/assets/coffee_can_radar/cars_on_vassar.png) |
|:--:|
| Range measurements of cars driving by |

### Synthetic Aperture Radar

The final experiment we ran was synthetic aperture radar (SAR) imaging, which involves taking multiple range measurements of an object from a moving location - we just physically moved out setup along a line.  These measurements are processed together to resolve structure, which we assume is stationary. Note that we produce 2D projections because we only moved along one dimension. We tried to image the "green building" at MIT from a breezeway connecting two other buildings looking on to it. The data we gathered is overlaid on to a Google Earth satellite image of the same location after aligning the scale and orientation and is shown below. We can see SAR is relatively noisy, but it is able to pick up the sides of some buildings that are in the line of sight.

| ![SAR image of green building](/assets/coffee_can_radar/green_bldg_goog_earth_with_SAR.png) |
|:--:|
| SAR image of green building |
